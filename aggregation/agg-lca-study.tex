\section{Foreground Study}

In practice, most LCA studies contain foreground information that is not present in a background database, and LCA software systems generally allow users to augment the standard LCIDBs with foreground models.  In consideration of our objectives, a disclosure should be limited to the foreground of a study and exclude the background.  The simplest conceivable foreground is simply what is given as the final demand, in other words the list of background processes invoked by the study and their activity levels.  For clarity, I introduce a ``canonical'' final demand vector in which the first entry is 1 and all successive entries are 0:
\begin{equation}
\tilde{\mathbf{y}} =  [ 1,\, 0,\, 0 ,\,\ldots,\, 0]^{T}
\label{eqn:canonical_y}
\end{equation}
The $A$ and $B$ matrices can be augmented with the $\mathbf{y]$ vector and a $\mathbf{0}$ vector respectively, to generate the same results using the canonical $\tilde{\mathbf{y}}$:
\begin{eqnarray}
s &= \mathbf{e}^T\times B\times\left(I-A\right)^{-1}\times\mathbf{y} \\
 &= \mathbf{e}^{T}\times\tilde{B}\times\left(I-\tilde{A}\right)^{-1}\times\tilde\mathbf{y}\\
\tilde{A} &= \left[\begin{array}{cc}
 0 & 0 \\
 \mathbf{y} & A
  \end{array}\right]\\
\tilde{B} &= \left[\begin{array}{cc} \mathbf{0} & B\right]  \end{array}
\label{eqn:canonical}
\end{eqnarray}
This is intuitively true because the canonical $\tilde{\mathbf{y}}$ selects the first column of the augmented $\tilde{A}$ matrix as the ``final demand,'' but the ``direct requirements'' of that column are precisely the final demand from the prior, un-augmented $A$ matrix.  It can easily be shown that the first equality in Eq.~\ref{eqn:canonical} holds for any $\mathbf{y}$.  \textit{author's note: if need be, a proof for this equality can be provided in the electronic supplementary information.}

Of course, most studies have a more elaborate foreground than simply the demand for processes in the background database.  To meet our disclosure objectives, it is important to be able to distinguish foreground content from background content in the computation.  Because background databases are prepared independently of any study, their computational results do not vary across all the studies in which they are used.  However, the foreground systems themselves cannot be computed without the background.  Put another way, the foreground depends on the background but the background does not depend on the foreground.  This condition allows the processes in an LCIDB to be sorted into foreground and background groups.  The processes an LCIDB containing both a foreground and a background can then be partially ordered to group foreground processes together \citep{Kuczenski_JLCA_2015}.  

Thus a foreground study can be written in block-triangular form, using the canonical functional unit $\tilde{\mathbf{y}}$, as follows:
\begin{equation}
\tilde{A} = \left[\begin{array}{cc}
A_f & 0 \\
A_d &  A
  \end{array}
\right];\;\;\;  \tilde{B} = \left[\begin{array}{cc} B_f & B   \end{array}\right]
\label{eqn:foreground}
\end{equation}

\input{fig_foreground}
In this case, the submatrix $A_f$ represents the foreground (the first column of which delivers the functional unit of the study); $A$ represents the background, and the rectangular matrix $A_d$ represents the dependency of the foreground on the background.  The ordered $\tilde{B}$ matrix is similarly partitioned into $B_f$, which includes foreground emissions, and $B$ which includes background emissions. The constitutive characteristic of this formulation is that the submatrix in the top right corner of $\tilde{A}$ is zero.  As long as this is the case, all computations regarding the background are invariant with respect to any foreground, and they can be computed in advance.\footnote{It should be noted that this condition does not hold for so-called ``integrated hybrid'' models, in which all quadrants contain non-zero cells.  The approach presented here applies only to LCA studies in which the background system is invariant with respect to the foreground. This class includes the vast majority of LCA case studes, and very likely includes all case studies prepared using commercial LCA software.}

It is currently common practice for background database maintainers to pre-compute the life cycle inventory results for their databases.  Using the notation $B_x = B \times (I - A)^{-1}$ to represent the pre-computed background LCI database, Eq.s~\ref{eqn:foreground} can be rewritten as:
\begin{equation}
 \tilde{A} = \left[\begin{array}{cc} 
A_f &  0 \\
A_d & 0 
   \end{array}\right];\;\;\;  \tilde{B} = \left[\begin{array}{cc} B_f & B_x \end{array}\right ]
\label{eqn:fg_bg}
\end{equation}
The proof of the equivalency of Eq.s\ref{eqn:foreground} and \ref{eqn:fg_bg} is provided in the supplementary information to \cite{Kuczenski_JLCA_2015}.  In this form, the main content of the LCIDB has been removed from the $\tilde{A}$ matrix, and the only information remaining there pertains to the study foreground.  Furthermore, the final demand vector has been replaced with a canonical functional unit and no longer needs to be explicitly reported.

Using the ordered matrices, Eq.~\ref{eqn:leontief} can be written so that the computationally costly foreground and background inversions can be performed separately:\footnote{For a demonstration of this equivalence, the reader is again directed to \cite{Kuczenski_JLCA_2015}.}
\begin{equation}
s = \mathbf{e}^T \times (B_f + B_x\times A_d) \times (I - A_f)^{-1} \times \tilde{\mathbf{y}}
\label{eqn:study}
\end{equation}

This formulation shows that given access to the background database $B_x$ and the characterization vector $\mathbf{e}$, the study results can be fully reproduced using only the submatrices $A_f$, $A_d$, and $B_f$.  Eq.~\ref{eqn:study} is visualized in Figure~\ref{fig:foreground}, with the background technology matrix $A$, having been subsumed into $B_x$, represented by an identity matrix $I$.  

An important intermediate result is the vector of activity levels for the foreground nodes $\tilde{\mathbf{x}}$, also visualized in Figure~\ref{fig:foreground}:
\begin{equation}
\tilde{\mathbf{x}} = (I - A_f)^{-1} \times \tilde{\mathbf{y}}
\label{eqn:inv}
\end{equation}
This vector can be used to describe an \emph{aggregated foreground}, which generates the same results as the fully expanded foreground:
\begin{equation}
\begin{array}{rl}
    \tilde{\mathbf{b}}_f & = B_f \times \tilde{\mathbf{x}} \\
    \tilde{\mathbf{a}}_d & = A_d \times \tilde{\mathbf{x}} \\
    \tilde{\mathbf{b}}_x & = B_x \times \tilde{\mathbf{a}}_d
\end{array}
\label{eqn:agg}
\end{equation}

These vectors summarize the contents of the foreground without disclosing its detailed structure.  The aggregated dependency vector $\tilde{\mathbf{a}}_d$ has the same dimension as the background database, and the aggregated emission vector $\tilde{\mathbf{b}}_f $has the same dimension as the elementary flow matrix.  The dependency vector can be transformed into an elementary flow vector by multiplying by $B_x$.  The result of the study $s$ is the sum of foreground and background impact scores:

\begin{equation}
\begin{array}{rl}
   \tilde{\mathbf{b}} & = \tilde{\mathbf{b}}_f + \tilde{\mathbf{b}}_x \\
   s &= \mathbf{e}^T \times \tilde{\mathbf{b}} \\
   & = \mathbf{e}^T \times \tilde{\mathbf{b}}_f + \mathbf{e}^T \times \tilde{\mathbf{b}}_x \\
   &= \tilde{s}_f + \tilde{s}_x
\end{array}
\label{eqn:lci}
\end{equation}

