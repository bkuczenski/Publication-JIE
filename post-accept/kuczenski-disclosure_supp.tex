\documentclass[12pt]{article}

%% formatting
\pagestyle{plain}
\usepackage[margin=1in]{geometry}

%% font selection
\usepackage{mathptmx}
\renewcommand\sfdefault{phv}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{textcomp}

\usepackage{setspace}
\usepackage{textcase}
\usepackage{amsmath,amssymb,mathrsfs}
\usepackage{booktabs}
\usepackage{array}

\usepackage{enumitem}
\setlist[enumerate,2]{label=(\alph*)}
\setlist[enumerate,3]{label=\roman*.}

%% pdf foo
\usepackage[svgnames]{xcolor}

\definecolor{hyperblue}{rgb}{0.01 0.04 0.45}
\usepackage{thumbpdf}

\usepackage[hyphens]{url}

\RequirePackage[colorlinks,breaklinks=true,hyperindex,plainpages=false,%
linkcolor=hyperblue,urlcolor=hyperblue,anchorcolor=hyperblue,%
citecolor=black,%
pdfstartview=FitH,pdfpagemode=UseOutlines,%
bookmarksopen=false]{hyperref}
\def\pdfBorderAttrs{/Border [0 0 0] } % No border arround Links
\setlength{\pdfpagewidth}{\paperwidth}
\setlength{\pdfpageheight}{\paperheight}
\usepackage{breakurl}
\urlstyle{same}

%% Appearance

\usepackage{parskip}
\setlength{\parindent}{0pt}

\newcommand{\doi}[1]{\mbox{doi:~\href{http://dx.doi.org/#1}{\small\texttt{#1}}}}
\newcommand{\email}[1]{\texttt{\href{mailto:#1}{#1}}}
\newcommand{\overbar}[1]{\mkern
  1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}

\let\oldtimes\times
\let\times\cdot

%\lhead{\sffamily Disclosure of product system models}
%\rhead{\sffamily Kuczenski -- 2017}

\usepackage{tabularx}
\usepackage[round]{natbib}
\usepackage{siunitx}


%% To build supporting information:
%% - uncomment supportingfalse
%% - in the document uncomment both mainpaper and supporting
%% - latex agg-JIE
%% - in the document [bottom] inside \ifsupporting, comment mainpaper
%% - maketex -x -o supp.pdf agg-JIE


\bibliographystyle{authordate_bk}

\renewcommand{\topfraction}{0.7}
\renewcommand{\bottomfraction}{0.7}

%\thispagestyle{empty}

\input{psstyle}
\input{../manuscript/draw-matrices}
\let\showgrid\relax


\title{Disclosure of Product System Models in Life Cycle Assessment: Achieving Transparency and Privacy}
\author{Brandon Kuczenski\\
Institute for Social, Behavioral, and Economic Research\\
University of California, Santa Barbara}
\date{Submitted after revision, 23 Apr 2018}

\usepackage{lineno}


\def\supporting{
  \date{Updated July 5, 2018}
  \setcounter{figure}{0}
  \setcounter{table}{0}
  \setcounter{page}{2}
  \setcounter{equation}{0}
  \renewcommand{\thefigure}{S\arabic{figure}}
  \renewcommand{\thetable}{S\arabic{table}}
  \renewcommand{\theequation}{S\arabic{equation}}
  \renewcommand{\thepage}{S-\arabic{page}}

  %\maketitle

  \begin{center}
    \Large Supporting Information
  \end{center}


  \section{List of Mathematical Symbols}

The symbols  used in the text are defined in Table~\ref{tbl:symbols}.

\begin{table}[p]
  \caption{List of Mathematical Symbols (references refer to the main text)}
  \label{tbl:symbols}
\small\sffamily
  \def\gap{0.85ex}
\begin{tabularx}{\textwidth}{cclXl}
  \toprule
  \textbf{Symbol} & \textbf{Formula} & \textbf{Size} & \textbf{Description} & \textbf{ref.} \\
  \midrule
  \multicolumn{5}{l}{Dimensions} \\[\gap]
  $m$ &  & scalar & Number of emissions & Eq.~1 \\
  $n$ &  & scalar & Number of process outputs in background database & Eq.~1 \\
  $p$ &  & scalar & Number of nodes in foreground model & Fig.~2\\
  $\phantom{'}p'$ & & scalar & Number of cut-off nodes in foreground & Fig.~4c \\
  $N$ & $n+p$ & scalar & size of augmented matrix & n.a. \\[\gap]
  \multicolumn{5}{l}{Classical LCA} \\[\gap]
  $A$ & & $n\oldtimes n$ & Direct requirements matrix (Leontief) & Eq.~1 \\
  $I-A$ & & $n\oldtimes n$ & Technology matrix & " \\%Eq.~\ref{eqn:leontief} \\
  $B$ & & $m\oldtimes n$ & Emission matrix & " \\%Eq.~\ref{eqn:leontief} \\
  $\mathbf{y}$ & & $n \oldtimes 1$ & Final demand vector & " \\%Eq.~\ref{eqn:leontief} \\
  $\mathbf{x}$ & $(I-A)^{-1}\times \mathbf{y}$ & $n \oldtimes 1$ & Activity level vector & Fig.~1 \\
  $\mathbf{b}$ & $B\times \mathbf{x}$ & $m \oldtimes 1$ & Life cycle inventory & " \\%Fig.~\ref{fig:lca} \\
  $\mathbf{c}$ & & $m \oldtimes 1$ & Characterization vector & Eq.~1 \\
  $s$ & $\mathbf{c}^T\times\mathbf{b}$ & scalar &  LCIA Result & " \\[\gap]%Eq.~\ref{eqn:leontief} \\[\gap]
  \multicolumn{5}{l}{Product System Model} \\[\gap]
  $\tilde{\mathbf{y}}$ & $[ 1,\, 0,\, 0 ,\,\ldots,\, 0]^{T}$ & $N\oldtimes 1$ & Canonical functional unit vector & Eq.~2 \\
  $\tilde{A}$ & & $N\oldtimes N$ &  Augmented $A$ matrix & Eq.~3 \\ 
  $\tilde{B}$ & & $m\oldtimes N$ &  Augmented $B$ matrix & " \\%Eq.~\ref{eqn:foreground} \\
  $A_f$ & & $p\oldtimes p$ &  Foreground matrix & " \\%Eq.~\ref{eqn:foreground} \\ 
  $A_d$ & & $n\oldtimes p$ &  Background dependency matrix & " \\%Eq.~\ref{eqn:foreground} \\ 
  $B_f$ & & $m\oldtimes p$ &  Foreground emission matrix & " \\%Eq.~\ref{eqn:foreground} \\
  $B_x$ & $B\times(I-A)^{-1}$ & $m\oldtimes n$ &  Background LCI database matrix & Eq.~4 \\
  $\tilde{\mathbf{y}}_f$ & $[ 1,\, 0,\, 0 ,\,\ldots,\, 0]^{T}$ & $p\oldtimes 1$ & Canonical foreground functional unit & " \\%Eq.~\ref{eqn:study} \\
  $\tilde{\mathbf{x}}$ & $(I-A_f)^{-1}\times\tilde{\mathbf{y}}_f$ & $p\oldtimes 1$ & Foreground activity vector & Fig.~2 \\[\gap]
  \multicolumn{5}{l}{Foreground Aggregation} \\[\gap]
  $\tilde{\mathbf{b}}_f$ & $B_f\times\tilde{\mathbf{x}}$ & $m\oldtimes 1$ & Aggregated foreground emissions & Eq.~5\\
  $\tilde{\mathbf{a}}_d$ & $A_d\times\tilde{\mathbf{x}}$ & $n\oldtimes 1$ & Aggregated dependencies & " \\%Eq.~\ref{eqn:agg}\\
  $\tilde{\mathbf{b}}_x$ & $B_x\times\tilde{\mathbf{a}}_d$ & $m\oldtimes 1$ & Aggregated background & " \\%Eq.~\ref{eqn:agg}\\
  $\tilde{\mathbf{a}}_f$ & & $p'\oldtimes 1$ & Vector of foreground cut-off flows & Fig.~4c \\
  $\tilde{\mathbf{b}}$ & $\tilde{\mathbf{b}}_x+\tilde{\mathbf{b}}_f$ & $m\oldtimes 1$ & Aggregated life cycle inventory & Fig.~4f\\[\gap]
  \multicolumn{5}{l}{Private Aggregation} \\[\gap]
  $\tilde{\mathbf{a}}_{d,priv}$ & & $n\oldtimes 1$ & Private dependencies & Eq.~7 \\
  $\tilde{\mathbf{a}}_d'$ & $\tilde{\mathbf{a}}_d-\tilde{\mathbf{a}}_{d,priv}$& $n\oldtimes 1$ & Disclosed dependencies & " \\%Eq.~\ref{eqn:partial} \\
  $A_{d,priv}$ & & $n\oldtimes p$ & Private dependency matrix & Eq.~8\\
  $A_{d,pub}$ & $A_d - A_{d,priv}$ & $n\oldtimes p$ & Public dependency matrix & " \\%Eq.~\ref{eqn:partition}\\
  $B_{b,priv}$ & & $m\oldtimes p$ & Private foreground emission matrix & " \\%Eq.~\ref{eqn:partition}\\
  $B_{f,pub}$ & $B_f - B_{f,priv}$& $m\oldtimes p$ & Public foreground emission matrix & " \\%Eq.~\ref{eqn:partition}\\
  $\mathbf{b}_{priv}$ & $(B_{f,priv} + B_x\cdot A_{d,priv})\cdot\tilde{\mathbf{x}}$ & $ m\oldtimes 1$ & Private life cycle inventory & Eq.~9\\
  $\varphi$ & Eq.~12 & scalar & Disclosure completeness metric & Eq.~12\\[\gap]
  \bottomrule
\end{tabularx}
\end{table}

\section{Mathematical Relations}

\subsection{Final Demand Augmentation}

This is a proof of Equation~2 in the manuscript.  

Given a life cycle inventory database (LCIDB) containing input-output matrix $A$ and emission matrix $B$, and a final demand vector $\mathbf{y}$, construct an augmented inventory database
$\tilde{A} = \left[\begin{smallmatrix} 0 & \mathbf{0}^T \\ \mathbf{y} & A \end{smallmatrix}\right]$,
$\tilde{B} = [ \mathbf{0},\, B ]$, and canonical functional unit $\tilde{\mathbf{y}} =  [ 1,\, 0,\, 0 ,\,\ldots,\, 0]^{T}$.  Show that
\begin{equation} B\times\left(I-A\right)^{-1}\times\mathbf{y} = \tilde{B}\times\left(I-\tilde{A}\right)^{-1}\times\tilde{\mathbf{y}}
\end{equation}

We begin by constructing $(I-\tilde{A})^{-1}$.  Because the matrix is block triangular, we only need to determine the value of $\mathbf{q}$ in the matrix below:
\begin{eqnarray}
  I &=&  (I-\tilde{A})^{-1}\times(I-\tilde{A})\\
  \left[\begin{array}{cc} 1 & \mathbf{0}^T \\
    \mathbf{0} & I
  \end{array}\right] &=&
  \left[\begin{array}{cc} 1 & \mathbf{0}^T \\
      \mathbf{q} & (I-A)^{-1}
  \end{array}\right]\times
  \left[\begin{array}{cc} 1 & \mathbf{0}^T \\
      -\mathbf{y} & (I-A)
        \end{array}\right]
\end{eqnarray}
It can be seen that $\mathbf{q}-(I-A)^{-1}\times\mathbf{y}=\mathbf{0}$ is a necessary condition to satisfy the equality, and thus $\mathbf{q}=(I-A)^{-1}\times\mathbf{y}$.

We know that $\tilde{\mathbf{y}}$ selects the first column of its argument, so:
\begin{equation}
  (I-\tilde{A})^{-1}\times\tilde{\mathbf{y}} = \left[\begin{array}{c}
      1\\
      \mathbf{q}
    \end{array}\right]
\end{equation}

And therefore

\begin{eqnarray}
  \tilde{B}\times(I-\tilde{A})^{-1}\times\tilde{\mathbf{y}} &=& \left[\begin{array}{cc}\mathbf{0}&B\end{array}\right]\times\left[\begin{array}{c}
      1\\
      \mathbf{q}
    \end{array}\right]\\
   &=&B\times\mathbf{q}\\
   &=&B\times(I-A)^{-1}\times\mathbf{y}
\end{eqnarray}
thus completing the proof.

\subsection{The Study Foreground Equation}

This section contains the derivation of Equation~4 in the manuscript, in two steps.

\subsubsection{``Flattening'' the background database}

First, information about the background database is removed from $\tilde{A}$ and replaced by an aggregated LCI database in a process I call ``flattening.''

Given a canonical LCA foreground study, show that the following formulations are equivalent:
\begin{eqnarray}
\tilde{A} = \left[\begin{array}{cc}
A_f & 0 \\
A_d &  A
  \end{array}
\right];&
  \tilde{B} = \left[\begin{array}{cc} B_f & B   \end{array}\right] \\
 \tilde{A}_{flat} = \left[\begin{array}{cc} 
A_f &  0 \\
A_d & 0 
   \end{array}\right];&  \tilde{B}_{flat} = \left[\begin{array}{cc} B_f & B_x \end{array}\right ]
\end{eqnarray}
where $B_x = B\times(I-A)^{-1}$.

It is sufficient to show that $\tilde{B}\times(I-\tilde{A})^{-1} = \tilde{B}_{flat}\times(I-\tilde{A}_{flat})^{-1}$.

Using the shorthand $Z=I-A$, we define the following identity:
\begin{equation}
  I* = \left[\begin{array}{cc}
      I & 0 \\
      0 & Z
    \end{array}\right]^{-1} \times
  \left[\begin{array}{cc}
      I & 0 \\
      0 & Z
    \end{array}\right]
\end{equation}

We introduce the identity in between the two terms of the LCIDB:
\begin{align}
  \tilde{B}\times(I-\tilde{A})^{-1} &=
  \left[\begin{array}{cc}B_f & B\end{array}\right]\times I*  \times
  \left[\begin{array}{cc}I-A_f & 0 \\ -A_d & I-A\end{array}\right]^{-1}\\
      &=  \left[\begin{array}{cc}B_f & B\end{array}\right]\times 
      \left[\begin{array}{cc}I & 0 \\ 0 & Z\end{array}\right]^{-1}\times
      \left[\begin{array}{cc}I & 0 \\ 0 & Z\end{array}\right] \times
      \left[\begin{array}{cc}I-A_f & 0 \\ -A_d & Z\end{array}\right]^{-1}
\end{align}
Using the associative property of matrix multiplication, it can be shown that $M\times N^{-1} = (N\times M^{-1})^{-1}$ for any invertible $M$ and $N$ of the same rank, so:
\begin{eqnarray}
  \tilde{B}\times(I-\tilde{A})^{-1}
  &=& \left[\begin{array}{cc}B_f & B\end{array}\right]\times 
      \left[\begin{array}{cc}I & 0 \\ 0 & Z\end{array}\right]^{-1}\times
\left(
\left[\begin{array}{cc}I-A_f & 0 \\ -A_d & Z\end{array}\right]\times
    \left[\begin{array}{cc}I & 0 \\ 0 & Z\end{array}\right]^{-1}\right)^{-1}\\
  &=&   \left[\begin{array}{cc}B_f & B\end{array}\right]\times 
      \left[\begin{array}{cc}I & 0 \\ 0 & Z^{-1}\end{array}\right]\times
\left(
\left[\begin{array}{cc}I-A_f & 0 \\ -A_d & Z\end{array}\right]\times
\left[\begin{array}{cc}I & 0 \\ 0 & Z^{-1}\end{array}\right]\right)^{-1}\\
 &=& \left[\begin{array}{cc}B_f & B\times Z^{-1}\end{array}\right]\times
\left(\left[\begin{array}{cc}I-A_f & 0 \\ -A_d & I\end{array}\right]\right)^{-1}
\end{eqnarray}
But these terms are equivalent to the flattened LCIDB:
\begin{eqnarray}
  \tilde{B}\times(I-\tilde{A})^{-1} &=&
  \left[\begin{array}{cc}B_f & B\times (I-A)^{-1}\end{array}\right]\times
\left(\left[\begin{array}{cc}I-A_f & 0 \\ -A_d & I\end{array}\right]\right)^{-1} \\
&=& \left[\begin{array}{cc}B_f & B_x\end{array}\right]\times
\left(I-\left[\begin{array}{cc}A_f & 0 \\ A_d & 0\end{array}\right]\right)^{-1}\\
&=& \tilde{B}_{flat}\times(I-\tilde{A}_{flat})^{-1}\label{eqn:si-flat}
\end{eqnarray}
thus completing the proof.

\subsubsection{Separating Background from Foreground}
  
Equation~4 in the manuscript is derived from Equation~\ref{eqn:si-flat} above.  It was also derived in Kuczenski (\citeyear{Kuczenski_JLCA_2015}).

We begin by computing $(I-\tilde{A}_{flat})^{-1}$, again taking advantage of the matrix's block triangularity.  Find $Q$ such that:
\begin{equation}
  \left[\begin{array}{cc} (I-A_f) & 0 \\ -A_d & I\end{array}\right]\times
  \left[\begin{array}{cc} (I-A_f)^{-1} & 0 \\ Q & I\end{array}\right] =
  \left[\begin{array}{cc} I & 0 \\ 0 & I\end{array}\right]
\end{equation}

It can be seen that $Q=A_d\times(I-A_f)^{-1}$ is a necessary condition to satisfy the equality, and thus:
\begin{equation}
  (I-\tilde{A})^{-1} = \left[\begin{array}{cc} (I-A_f)^{-1} & 0 \\ A_d\times(I-A_f)^{-1} & I\end{array}\right]
\end{equation}.

Substituting this into the LCA system equation:
\begin{align}
  s =\;& \mathbf{c}^T\times \tilde{B}_{flat}\times(I-\tilde{A}_{flat})^{-1}\tilde{\mathbf{y}}\\
  =\;& \mathbf{c}^T\times \left[\begin{array}{cc} B_f & B_x \end{array}\right]\times
  \left[\begin{array}{cc} (I-A_f)^{-1} & 0 \\ A_d\times(I-A_f)^{-1} & I \end{array}\right]
  \times\left[\begin{array}{c} \tilde{\mathbf{y}}_f \\ \mathbf{0}\end{array}\right]
\end{align}
where $\tilde{\mathbf{y}}_f$ is a canonical functional unit having the same dimension as $A_f$.  Thus:
\begin{align}
s =\;& \mathbf{c}^T\times \left[\begin{array}{cc} B_f & B_x \end{array}\right]\times
 \left[\begin{array}{c} (I-A_f)^{-1}\times\tilde{\mathbf{y}}_f \\ A_d\times(I-A_f)^{-1}\times\tilde{\mathbf{y}}_f\end{array}\right]\\
 =\;& \mathbf{c}^T\times \left(B_f\times(I-A_f)^{-1}\times\tilde{\mathbf{y}}_f
 + B_x\times A_d\times(I-A_f)^{-1}\times\tilde{\mathbf{y}}_f\right)\\
 =\;& \mathbf{c}^T\times \left(B_f + B_x\times A_d\right)\times(I-A_f)^{-1}\times \tilde{\mathbf{y}}_f\\
 =\;& \mathbf{c}^T\times \left(B_f + B_x\times A_d\right)\times \tilde{\mathbf{x}}
\end{align}
thus completing the derivation.

\section{On the Equivalence of Process and Input-Output LCA}

There is a level of confusion about the differing implications of process-based LCA inventory analysis as described in Heijungs and Suh (\citeyear{Heijungs2002}), and input-output analysis using a Leontief matrix.  In fact, these two techniques were shown to be equivalent in Suh et al (\citeyear{Suh_JIE_2010}), whose abstract declares: ``the article shows that the partitioning method in LCA is equivalent to the industry-technology model in input-output economics, and system expansion in LCA is equivalent to the by-product-technology model in input-output output economics.''  The article does indeed show convincingly that ``the two data types can be hybridized without the loss of methodological consistency'' (p.345).

   Both the technology matrix $A$ in LCA and the Leontief matrix $(I-A)$ in input output analysis are ways of encoding the relationships between the products that some processes ``make'' and other processes ``use.''  In either the classical or input-output formulation, both matrices must be put into symmetric form to be invertible, and this means describing each column as having a single, reference output.  This is done either through disaggregation (i.e. dividing a process by its various outputs), aggregation (i.e. combining products to form a market or industry), or some combination of these.  While the task of transforming data is highly case-dependent, it is not constrained by the choice of mathematical formalism.  
   
   Suh et al, after a rich investigation of the literature, a thorough mathematical development, and a worked example, conclude that ``even very large-scale LCI problems, such as those in commercial LCI databases, can be computed with a consistent mathematical framework$\ldots$'' that being the make-and-use framework (p. 349).  In effect, the different mathematical approaches can be made equivalent.  The equivalency can be made very plain by simply reinterpreting the input-output expressions \textit{as} technology matrices.  In other words, (in Suh et al) the expressions $(I-A_I)$ (eq. 6), $(I-A_C)$ (eq. 9), $(I-A_B)$ (eq. 12), and $(V'-U)$ (eq. 17) can simply be interpreted as \textit{different ways to formulate} the process-based technology matrix.  There is no inconsistency between this interpretation and the classical formulation.  

   Once single-output processes are obtained, one substantive difference between the various approaches is column scaling: whether the entries describe real outputs, unit outputs, or unit activity levels.  The database creator must ensure that a consistent scaling is applied to both the technology matrix and the emission matrix $B$.  The convention in LCA is for a column to represent a unit activity level.  To use the input-output coefficient approach, as in the present article, the columns must be scaled to a \textit{unit of the reference product}.  This reference output is then omitted from the $A$ matrix, and is instead supplied by the $I$ in the expression $(I-A)$.  This formulation is completely consistent with any other matrix-based formulation of LCA, including classical process LCA as traditionally practiced.  In particular, the approaches described here apply equally well to LCA models using both process-based databases such as Ecoinvent, input-output databases such as Exiobase, and background databases such as the GaBi databases.

   Interested readers should note that the canonical reference for LCA, ISO 14044, has nothing to say about the mathematical techniques used to solve LCA problems, and the only preference for a technology matrix over an input-output matrix is borne of tradition or custom rather than theory.  SimaPro, the leading worldwide software system for scientific LCA, converted to using an iterative Leontief inverse for Version 8, as disclosed in a whitepaper published in 2014\footnote{\url{https://www.pre-sustainability.com/news/new-calculation-engine-simapro-8}}, realizing significant speed and memory usage improvements.  OpenLCA, the open-source alternative, also reported a dramatic reduction in memory usage and computation time around the release of version 1.4 in 2014, coincident with a revised algorithm ``optimized for huge databases.''\footnote{\url{http://www.openlca.org/openlca-beta-1-4-released-optimised-for-huge-databases/}} This is highly suggestive of a switch to an iterative approach.  GaBi, the more industrially oriented software, does not use a matrix formulation at all, but has always computed activity levels using iteration at the plan level.

   
\section{Meeting the Disclosure Objectives}

\subsection{Transparency}

The objective for transparency was identified as requiring computability, completeness, and reproducibility.  These requirements can be met by a disclosure that clearly describes the identities of each row or column of $A_f$, $A_d$, and $B_f$ containing non-zero entries, and the locations and values of those entries.  In principle, a reader with this information would have the capability to construct the augmented LCIDB and perform the computation in Eq.~4.  In actuality, while it is easy to reproduce a set of sparse matrices, there is considerable potential for ambiguity in stating the identities of the rows and columns of those matrices.

The foreground nodes, which make up the columns of $A_f$, can be chosen freely by the study author according to the objectives of the study.  Large studies may contain hundreds of foreground nodes, and the nodes can correspond to physical activities, logical operations, unit conversions, accumulation or distribution points, or any other aspect of model construction that can be reflected in a process-flow diagram.  The only requirement on their disclosure is that the identity of each node's reference flow, including its unit of measure, is clearly stated.  

For each row in $A_d$ containing a non-zero entry, the author must unambiguously identify the exact dataset used, including the version of the database, as well as the exact process and reference flow selected; the dimension (reference quantity or unit) of each reference flow must be specified; and the sign of the numeric entry in $A_d$ must be consistent with the implementation of the process in the background database.  Similarly, for each row in $B_f$ containing a non-zero entry, the author must unambiguously identify the substance being exchanged with the environment, the compartment or context into which it is being exchanged, and the reference quantity or unit associated with the flow.  Sign consistency must also be assured.  If LCIA indicator results are included, the author must also unambiguously identify the method computed (identity of $\mathbf{c}$).

\subsection{Authority and Originality}

It may be observed that many LCA studies make use of data sources that have been previously published but that have not been included in any LCI reference or background database.  As long as these data sources can be integrated seamlessly into an LCA computation, it is not necessary to reproduce them in a disclosure.  However, in most applications, previously published data must be re-implemented by the author in the LCA software context, and often this re-implementation requires a re-interpretation of the data source as a unit process inventory, where one exchange is recognized as a reference flow and other exchange values are reported in proportionality to the reference flow.

Because of these conditions, in the vast majority of cases the LCA study disclosure must include the author's reimplementations in order to achieve both the aims for authority and originality.  In so doing, the disclosure enables a critical reviewer to evaluate whether the author's implementations are generally correct and complete.

In the future, the inclusion of external data automatically can be accomplished in the same way that reference LCI data could conceivably be included automatically: by the data providers making their information available  using a stable semantic reference to a specialized Web-based application programming interface (API).  This would have the benefits of enabling downstream users to access the information without having to re-implement it, thus reducing the size of the disclosure necessary to describe the PSM and simplifying the task of the modeler.

\section{Preparing the Foreground Matrix}

The development in the main text assumes the product system model is already described as a symmetric collection of single-output processes (activities) and flows (commodities) related by coefficients.  In concrete terms, this means that:
\begin{itemize}
\item each node in the foreground (column shared by $A_f$, $A_d$, and $B_f$) corresponds to a particular flow in the model's foreground (row of $A_f$);
\item a unit activity of each node in the foreground corresponds to a unit output of each flow;
\item the coefficients in $A_f$, $A_d$, and $B_f$ are ratios expressing the quantity of the flow (row), in its native unit, exchanged per unit of the reference flow (column). 
\end{itemize}

Each foreground column has both an intrinsic reference flow and a unit of measure, and the use of this flow by other processes must be made with regard to this measure.  The activity level of each foreground node necessarily equals the magnitude of the total reference flow emanating from the node.  For background dependencies and emissions (rows of $A_d$ and $B_f$, respectively), the modeler must take care to use the units established by the references, but in the foreground case the modeler must ensure to be self-consistent in preparing the $A_f$ matrix. 


\subsection{Simple Foreground Networks}

\begin{figure}[p]
  \begin{center}
    \begin{pspicture}(0,-7)(14,11)\showgrid
      \small
      \rput[tl](0,11){\input{../figures/fig3a-sequential.fig}}
      \rput[bl](0,0){\input{../figures/fig3b-additive.fig}}
      \rput[bl](0,-5.5){\input{../figures/fig3n-cyclic.fig}}
      %\rput[tl](6,12){\input{fig3c-unitprocess.fig}}
      \rput[br](14,-3){\input{../figures/fig3c-fragment.fig}}
    \end{pspicture}
    \caption{Equivalent matrix representations and graphs for different foregrounds.}
    \label{fig:fragments}
  \end{center}
\end{figure}

Figure~\ref{fig:fragments} illustrates the structure of some basic foreground configurations.  Most product system models would include many of these elements mixed together.  All the activities in these examples are single-output.
The first (a) is a sequential model, in which each node requires one foreground input and generates one output. This model is equivalent to a ``gate to gate'' model.  Here the weights $k_i$ indicate the amount of the preceding reference flow that is required by the subsequent node.  Figure~\ref{fig:fragments}(b) shows an additive model, in which the outputs of several foreground nodes are added together, equivalent to a ``mixer'' or a horizontal average.  In this arrangement the weights %represent the relative weights of each input, and
should add up to a unit output of the reference node.  Figure~\ref{fig:fragments}(c) shows a foreground model with a cyclic dependency, where some of the reference output is consumed by another foreground node.

A typical PSM may contain multiple modules or fragments that are interconnected.  An example of foreground composed of several fragments is illustrated in Figure~\ref{fig:fragments}(d).  Here, the nodes labeled 1--5 represent one fragment, which generates the foreground's canonical reference flow $\tilde{y}$. This fragment requires two interior flows from separate fragments ($y_0$ and $y_1$), and has two unconnected flows (4 and 5).  The reference $y_0$ is supplied by a second fragment, made up of nodes 6-8.  The reference $y_1$ is supplied by another fragment made of only one node (9). The reference flow $y_1$ is consumed in two different places by the other fragments.

As noted, a reviewer with access to items \emph{d-i} and \emph{d-iv} in the disclosure would be able to construct $A_f$ and automatically create a process-flow diagram, annotated with information about each node.

\subsection{Multi-Output Foreground Processes}

The treatment of multi-functional activities in LCA is a topic of constant discussion among practitioners and theorists.  While the question of the correct, appropriate, or ideal method of apportioning impacts among co-products cannot be resolved in general, the utility of a disclosure framework must be to \textit{express} transparently how co-production was resolved within a given foreground model.  Majeau-Bettez et al. (\citeyear{Majeau_Bettez_2014}) recently provided a general framework (referred to hereafter as MWS14) for describing the treatment of co-products, and I adopt that framework here to show how the technique used to handle co-production can be disclosed transparently for foreground processes.

\subsubsection{Example System}

In all strategies, an abbreviated example system drawn from Ecoinvent, reporting chlor-alkali electrolysis using a membrane cell, is used.  The un-allocated system is shown in Table~\ref{tbl:chlor-alkali}.

\begin{table}
  \begin{center}
  \caption{Example: Chlor-alkali electrolysis, membrane cell [RER] (Ecoinvent 3.2; excerpt)}
  \label{tbl:chlor-alkali}
  \begin{tabular}{rccl}
    \toprule
    \bf Flow & \bf Unit & \bf Direction & \bf Value \\
    \midrule
    \multicolumn{4}{l}{Reference:} \\
    Chlorine, gaseous & kg & Output & 1 \\
    Hydrogen, liquid & kg & Output & 0.028 \\
    Sodium hydroxide & kg dry & Output & 1.13 \\
    \midrule
    \multicolumn{4}{l}{Requirements:} \\
    Electricity, medium voltage & kWh & Input & 2.97 \\
    Sodium chloride, powder & kg & Input & 1.75 \\
    Chemical factory, organics & unit & Input & 4e-10 \\
    Sludge, NaCl electrolysis & kg & Output & 0.0153 \\[1ex]
    \multicolumn{4}{l}{Emissions:} \\
    Chloride [16887-00-6], surface water & kg & Output & 0.015 \\
    Carbon dioxide [124-38-9], urban air & kg & Output & 0.0031 \\
    \bottomrule
  \end{tabular}
  \end{center}
\end{table}

The objective is to disclose explicitly how the multi-output system was resolved to single-output activities for the purposes of review, reproduction, or modification.  Therefore, the raw (un-allocated) process inventory is included in all cases.  Examples are provided for partitioning allocation, classical system expansion, and consequential system expansion.

\subsubsection{Partitioning Allocation}

According to MWS14, Partitioning allocation (PA) is a ``production-balanced model that artificially splits the requirements of an activity across its different outputs.''  The exact manner of the partitioning need not be specified, as long as the parts sum up to the whole.  In the disclosure framework, any manner of production-balanced partitioning can be represented by including the raw, un-allocated inventory as one foreground column, choosing any output as the reference.  The other $n-1$ outputs are then included as allocated inventories in additional columns, for a total of $n$ columns.  Each column must be normalized to a unit reference.

Note that, although it is customary for allocated process inventories to be derived as a uniform partition of the un-allocated process based on some parameter such as mass, price or energy content, this is not necessary.  For a process with $n$ outputs the modeler has $n-1$ degrees of freedom in specifying the allocated inventories, with the requirement that the $n$th inventory equals the remainder.  In the framework presented, the modeler must provide the $n-1$ allocated inventories explicitly.  The reference flow for the $n$th process will simply be computed as the remainder when the allocated inventories are subtracted from the un-allocated inventory.

\begin{table}
  \begin{center}
  \caption{Chlor-alkali electrolysis as a foreground model, partitioning allocation}
  \label{tbl:partition}
  \footnotesize\sffamily
  \begin{tabular}{l|ccc}
    \midrule
    \bf $A_f$ & 0 & 1 & 2 \\
    \midrule
    \textbf{Chlorine, gaseous (kg)} & $\ast$ & & \\
    Hydrogen, liquid (kg) & -0.028 & $\ast$ & \\
    Sodium hydroxide (kg dry) & -1.13 & & $\ast$ \\
    \midrule
    \bf $A_d$ & 0 & 1 & 2 \\
    \midrule
    Electricity, medium voltage (kWh) & 2.97 & 1.38 & 1.38 \\
    Sodium chloride, powder (kg) & 1.75 & 0.811 & 0.811 \\
    Chemical factory, organics (unit) & 4e-10 & 1.9e-10 & 1.9e-10 \\
    Sludge, NaCl electrolysis (kg) & 0.0153 & 0.00709 & 0.00709 \\
    \midrule
    \bf $B_f$ & 0 & 1 & 2 \\
    \midrule
    Chloride, to surface water (kg) & 0.015 & 0.00695 & 0.00695 \\
    Carbon dioxide, to urban air (kg) & 0.0031 & 0.00144 & 0.00144 \\
    \midrule
  \end{tabular}
  \end{center}
\end{table}
    

Table~\ref{tbl:partition} illustrates this for the chlor-alkali example, for conventional allocation by mass.  The un-altered inventory is shown in column $0$, corresponding to the reference product of gaseous chlorine.  Co-products are shown as additional foreground flows, with negative signs indicating that the flows are outputs.  The reference for each column is indicated by an asterisk.

The inventories themselves are shown as entries in the $A_d$ and $B_f$ matrices. Because all co-products are already reported in mass, the allocated inventories for the two co-products are both the same and represent a scaling-down of the un-allocated inventory by the total mass of outputs (about 2.16 kg).

Using the foreground in Table~\ref{tbl:partition}, LCA computation using the canonical functional unit (see main text, Eq.~3) will automatically compute the self-consistent single-output result for 1 kg of chlorine gas because the allocated inventories for hydrogen and sodium hydroxide will be subtracted from the total.  The foreground activity levels for the system are:

\begin{equation}
  \tilde{\mathbf{x}} = [1,\,-0.028,\,-1.13]^T
\end{equation}

with the resulting aggregated dependency and emission vectors being, again, the same as the normalized and allocated inventories:

\begin{eqnarray}
  \tilde{\mathbf{a}}_d = A_d\times \tilde{\mathbf{x}} = & [1.38,\, 0.811,\,\num{1.9e-10},\,0.00709]^T \\
  \tilde{\mathbf{b}}_f = B_f\times \tilde{\mathbf{x}} = & [0.00695,\, 0.00144]^T
\end{eqnarray}

At the same time, LCA computation using a functional unit of one of the co-products will simply make use of the allocated inventory.  In this example, all processes are identical on a mass basis, but any other partitioning allocation can also be automatically rendered self-consistent through this approach.  A reviewer would be able to inspect the foreground model to determine whether the allocation was performed as described in the report.

\subsubsection{``Classical'' System Expansion}

Although the term `system expansion' is often used to refer to product substitution and/or alternate activity allocation, these modeling techniques are distinct and should be referred to with different names, as noted in GWS14.  In the original definition of system expansion, the functional unit is simply enlarged to include all co-products.  Representation of such a system is trivial and is shown in Table~\ref{tbl:cse}.

\begin{table}[h]
  \begin{center}
  \caption{Chlor-alkali electrolysis as a foreground model, classical system expansion}
  \label{tbl:cse}
  \footnotesize\sffamily
  \begin{tabular}{l|ccc}
    \midrule
    \bf $A_f$ & 0 & 1 & 2 \\
    \midrule
    \textbf{Chlorine, gaseous (kg)} & $\ast$ & & \\
    Hydrogen, liquid (kg) & -0.028 & $\ast$ & \\
    Sodium hydroxide (kg dry) & -1.13 & & $\ast$ \\
    \midrule
    \bf $A_d$ & 0 & 1 & 2 \\
    \midrule
    Electricity, medium voltage (kWh) & 2.97 &  &  \\
    Sodium chloride, powder (kg) & 1.75 &  & \\
    Chemical factory, organics (unit) & 4e-10 &  &  \\
    Sludge, NaCl electrolysis (kg) & 0.0153 &  &  \\
    \midrule
    \bf $B_f$ & 0 & 1 & 2 \\
    \midrule
    Chloride, to surface water (kg) & 0.015 &  &  \\
    Carbon dioxide, to urban air (kg) & 0.0031 &  &  \\
    \midrule
  \end{tabular}
  \end{center}
\end{table}

In the classical system expansion case, applying the expanded functional unit of 1 kg chlorine, plus 0.028 kg hydrogen and 1.13 kg of sodium hydroxide, will result in a unit activity of the reference process, without any cut-off flows.  Equivalently, the canonical functional unit, production of 1 kg of chlorine gas, will result in the same process activity level, and will also generate the co-products as cutoff flows.

\subsubsection{Consequential System Expansion}

The foreground disclosure framework is also well suited to describe consequential system expansion through product substitution or ``alternate activity allocation,'' which are the terms used in MWS14.  An example illustrating these methods is shown in Table~\ref{tbl:exp}

\begin{table}[t]
  \begin{center}
  \caption{Chlor-alkali electrolysis as a foreground model, consequential system expansion.  An inventory for the electrolysis of water (shown in blue) is provided as an alternate activity to produce hydrogen, while the sodium hydroxide product is assumed to substitute for for magnesium hydroxide (shown in red).}
  \label{tbl:exp}
  \footnotesize\sffamily
  \psset{unit=0.5cm}
  \begin{tabular}{l|cccc}
    \midrule
    \bf $A_f$ & 0 & 1 & 2 & \blue\textit{3} \\
    \midrule
    \textbf{Chlorine, gaseous (kg)} & $\ast$ & & &\\
    Hydrogen, liquid (kg) & -0.028 & $\ast$ & &\\
    Sodium hydroxide (kg dry) & -1.13 & & $\ast$ & \\
    \blue\textit{Hydrogen, electrolysis (kg)} & & \blue\textit{1} & & $\ast$ \\
    \midrule
    \bf $A_d$ & 0 & 1 & 2 & \blue\textit{3}\\
    \midrule
    Electricity, medium voltage (kWh) & 2.97 &  & & \blue\textit{50} \\
    Sodium chloride, powder (kg) & 1.75 &  & & \\
    Chemical factory, organics (unit) & 4e-10 &  & &  \\
    Sludge, NaCl electrolysis (kg) & 0.0153 &  & & \\
    \blue\textit{Water, distilled} (kg) & & & & \blue\textit{9} \\
    \red\textit{Magnesium hydroxide (kg dry)} & & & \red\textit{0.8} & \\
    \midrule
    \bf $B_f$ & 0 & 1 & 2 & \blue\textit{3}\\
    \midrule
    Chloride, to surface water (kg) & 0.015 &  & & \\
    Carbon dioxide, to urban air (kg) & 0.0031 &  & & \\
    \midrule
  \end{tabular}
  \end{center}
\end{table}

Here an alternate activity, namely electrolysis of water, is included for liquid hydrogen production and is specified at index 3 in the foreground  (shown in blue).  The inventory converts 9 kg of water to 1 kg of hydrogen using 50 kWh of electricity.  The hydrogen produced from the multi-output reference process is (somewhat dubiously) taken to displace hydrogen produced through the alternate activity by introducing a unity coefficient in row 3, column 1 of $A_f$.

Meanwhile, sodium hydroxide from the reference process is modeled to substitute the production of magnesium hydroxide through the introduction of a new row and a new nonzero coefficient in column 2 of $A_d$ (shown in red). Here the match is inexact, and because magnesium hydroxide is more effective in some applications, 1 kg of sodium hydroxide is taken to displace only 0.8 kg of magnesium hydroxide.

\section{Examples}

LCI databases often contain product systems that can be modeled as foreground studies because they describe products that are not required by the background.  In this section, two product systems selected from LCI databases are used to illustrate the concept of structured publication.  The systems selected because are complex enough to illustrate the premise but simple enough to review easily.

Each system is illustrated as a table that shows the foreground model, cutoff flows, background dependencies and foreground emissions included in the system.  Aggregation results $\tilde{\mathbf{x}}$, $\tilde{\mathbf{a}}_d$, and $\tilde{\mathbf{b}}_f$ are also reported.  The table omits numeric data from most of the table for clarity. Instead, a black square indicates the presence of a nonzero value.  %The systems are also reproduced as structured publications in the supplementary materials, formatted as Excel spreadsheets.

\subsection{US LCI: Secondary Aluminum}

\begin{figure}
  \input{../figures/aluminum-secondary}
  \caption{A structured product system model for secondary aluminum, drawn from US LCI. Exchange values are replaced with black squares for clarity.}
  \label{table:aluminum}
\end{figure}

The US LCI database contains a small background system of 39 processes, as well as 395 foreground product systems that range in size from one to 83 foreground flows.
%The largest, ``paper, freesheet, coated, at mill'' makes reference to 34 of the 39 background processes.

The example product system  reports the production of secondary aluminum from automotive scrap (Figure~\ref{table:aluminum}).   The aluminum production process has direct requirements for two other foreground systems, including transportation services and quicklime production.  The quicklime production itself depends on limestone extraction, which is also part of the foreground.  The aluminum production requires two background systems, electricity and natural gas combustion, and reports 10 cutoff flows.  The main input to the process, ``Aluminum scrap, automotive,'' appears as a cutoff flow.  Overall, the four foreground processes require the background for only combustion (five fuels), transport (three modes) and grid electricity.  The same natural gas combustion and electricity models were used in all three non-transport foreground nodes.

The system also reports several direct emissions, mainly from the aluminum process.  Only one resource consumption (input flow) is reported -- the extraction of limestone. The direct emission modeling is limited in scope and includes a number of ``unspecified'' flows that may not be well characterized in many impact methods.

%The structured publication of the secondary aluminum model includes a total of 47 data points about 36 entities.  The $A_f$, $A_d$, and $B_f$ matrices are reported in sparse format, along with the aggregation vectors. In the publication, LCIA scores are reported for several impact indicators drawn from the Ecoinvent reference LCIA implementation.\footnote{The Ecoinvent LCIA factors are not published, but are available from the Ecoinvent Centre. The name of the file used in the current study is \texttt{LCIA implementation v3.1 2014\_08\_13.xlsx}.}    The $E$ matrix is also partially reproduced: entries are only reported if they match flows that appear in the foreground.

\subsection{Ecoinvent: Organic Potatoes}

\begin{figure}
  \input{../figures/potato-organic}
  \caption{A structured product system model for organic potato production, drawn from Ecoinvent v3.2 (APOS). Exchange values are replaced with black squares for clarity.}
  \label{table:potato}
\end{figure}

Ecoinvent version 3 is provided in three different system models that reflect different linking strategies.  The example is drawn from the ``Allocation at the point of substitution'' or APOS model of Ecoinvent 3.2, which includes 11,420 processes that produce 12,966 product flows.  Of these, 10,282 are background flows and the rest are foreground flows.

The example system reports production of organic potatoes supplied to the global market (Figure \ref{table:potato}).  The foreground includes nine nodes, of which six (nodes 3 through 8) contain cyclic dependencies associated with the production of potato seeds.  The Ecoinvent database's use of ``markets'' as mixer processes is evident in the table: node 0 is a mixer process that combines Swiss (``CH'') production (node 1) weighted at 2.4\%  with rest-of-World (``RoW'') production (node 2) weighted at 97.6\%.  That same market split (2.4 / 97.6) can also be seen in nodes 4 and 8.

Nodes 5 and 6, which make seeds ready ``for setting,'' are mixed by node 8. Although nodes 5 and 6 are geographically distinguished (CH vs RoW), both can be seen to consume potato seed from the global market.

Looking at the dependency and emission lists, the different ``signatures'' of different kinds of processes can be seen: nodes 1, 2, 3, and 7 are clearly agricultural processes that require irrigation, tillage, manure and so on.  Nodes 0 and 4 are visible as market processes, their only requirements being transport processes.  Nodes 5 and 6 each consume electricity and require use of a ``multi-storey building.''  Taken together, the CH-locality processes appear to use CH irrigation and electricity supply but are otherwise similar to their RoW counterparts.  The product model includes no cutoff flows.

%The structured publication of the organic potato model reports the $A_f$, $A_d$, and $B_f$ matrices in full rather than sparse format to enable a more visually immediate review.  In addition, the $E$ matrix is reported in full, for all emissions found in the model, rather than only the emissions found in the foreground.  This enables the publication to be used to visually evaluate different implementations of the same impact assessment method in the context of the inventory model (Ecoinvent vs ILCD implementations of ReCiPe Midpoint marine eutrophication; see supplementary materials for details).



 \bibliography{kuczenski-disclosure}
}


\begin{document}

\supporting

\end{document}
